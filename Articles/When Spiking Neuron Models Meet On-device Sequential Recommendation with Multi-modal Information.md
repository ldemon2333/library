# 1 Intro
SSR

为了证明其稳健性和公平性，我们开发了一个名为 SSR（Spike-wise Sequential Recommendation 的缩写）的基准测试工具包，从准确率和能耗两个角度对纳入的方法进行全面比较，得出了对该方向未来发展具有启发意义的结论，并为基于 SNN 的骨干模型集成多模态信息提供了多种选择。在六个数据集上进行的大量实验结果表明，与相应的 ANN 基线相比，我们提出的基于 SNN 的 SR 算法在总能耗方面显著降低，而准确率的损失几乎可以忽略不计，这证明了其在提升边缘设备可持续性方面的潜力。

总体而言，我们的贡献概括如下：
• 本研究是将 SNN 应用于设备端 SR 问题的先驱之一。凭借 SNN 的节能优势，我们的方法可以通过延长设备使用时间，同时保持推荐性能，来提升用户体验和对连续多媒体内容的参与度。
• 提出了一个基准测试工具包，其中包含一系列脉冲 SR 模型及其相应的基于 ANN 的原型，以便从准确性和能耗角度对设备端 SR 任务进行公平、严格的比较。
• 通过开展大量实验，本研究提供了深刻的发现，并显著推进了 SNN 在集成多模态信息的设备端 SR 中的应用。
• 在六个不同的推荐数据集和五个最佳模型上进行的大量实验结果，验证了我们提出的基于 SNN 的方法对于下游设备端 SR 任务的可行性和有效性。这些提出的方法显著降低了总体能耗，同时在各种应用中准确率的损失几乎可以忽略不计。

# 2 Preliminary
## 2.2 Sequential Recommendation


# 3 Methodology
## 3.1 Overview of Benchmarking Toolkit
鉴于缺乏用于实证研究的脉冲神经网络 (SNN) 相关的 SR 基线，我们开发了一个用户友好的 Python 工具包来实现脉冲序列推荐 (SSR)。现有推荐库（例如 RecBole [29] 和 daisyRec [19]）主要旨在对众多最先进的推荐系统的准确率进行基准测试和复现，而 SSR 旨在提供一系列具有不同基本网络架构的脉冲序列基线，并在能量级和准确率两方面对这些基线及其对应的基于 ANN 的原型进行严格的评估。我们希望 SSR 的发布能够鼓励和促进更多 SNN 相关算法在设备端 SR 任务中的提出，从而丰富 SNN 的应用。
![[Pasted image 20250511201254.png]]
图 1 描述了 SSR 的整体工作流程。具体来说，
Loader 的主要任务是（1）自动加载和预处理来自不同平台的原始数据集；（2）将多模态信息（token、图像、文本等）转换为语义序列数据集，用于预测下一个交互项；（3）根据不同维度将整个数据集拆分为训练集和测试集。目前，Recommender 中包含一个模型库，其中包含多个基于 ANN 的最先进的 SR 算法及其相应的脉冲变体。Evaluator 则包含两个组件：Tuner 和 Metric，其中，Tuner 提供各种超参数采样方法用于自动调优；Metric 从两个方面对算法进行评估：经典排序准确率和估计的推理能耗。

所有 SSR 模块均用户友好且易于定制，可将新的设备端 SR 算法无缝集成到这个可扩展的框架中。

## 3.2 Spike-wise Model Modification
图 2 展示了本研究中实施的各种脉冲修改，旨在在 SSR 推荐器库中提出基于 SNN 的模型。与相应的基于 ANN 的 SR 原型相比，所有脉冲模型都表现出类似的架构，用于生成用户偏好的表示。

![[Pasted image 20250511201719.png]]
图网络考虑了会话序列中项目之间的复杂结构和转换 [24]。在SR场景中，图通常与项目表示相结合，以建模项目之间的拓扑结构和潜在因子 [38]，如图 2c 所示。经过图网络编码后，新的序列嵌入将转换为脉冲，类似于第 3.2.1 节，以便进一步进行脉冲解码。

脉冲 Transformer。Transformer 是用于生成序列用户偏好表示以用于推荐的模块。Transformer 通常包含两个独立的组件：一个用于捕捉序列级偏好特征的特征提取器（自注意力机制 [11]、傅里叶变换 [36] 等）；以及一个用于更复杂非线性投影的前馈网络。

值得注意的是，对于那些特征提取器中的方法受其功能限制且无法进行脉冲修改的 Transformer，我们努力仅将前馈部分转换为脉冲网络，同时保持原始特征提取器的完整性。

## 3.3 多模态信息集成
在现实世界的SR任务中，交互商品序列并非唯一可用的信息。其他多模态信息，例如商品详情、相关评论和封面图片，也可以被纳入其中以提升模型性能[10, 34]。然而，对于SNN来说，处理多模态信息的技术非常复杂，可能不适合部署在资源受限的边缘设备上。为了解决这个问题，我们设计了一个原生的服务器-设备协作框架，将SSR加载器中资源密集型的特征提取操作转移到服务器端，从而部分减轻了设备端的计算负担。

该框架的工作流程如图 3 所示。服务器接收到用户历史浏览过的商品序列后，会按顺序从数据库中收集所有相关的多模态辅助信息，然后在特征提取器中使用预先训练的语言和视觉模型提取相应的高阶表示。随后，这些提取出的特征将与相应的预先训练的商品表示连接并打包，并作为输入广播给部署在边缘设备上的推荐器。随后，基于脉冲的设备上推荐器将整合所有接收到的信息以增强最终预测，并将用户在下一步最有可能与之交互的商品 ID 发送到服务器。最后，服务器将特定商品的相关信息返回到用户的设备。
![[Pasted image 20250511203558.png]]

# 4 Experiments
4.1.1
数据集。为了验证我们提出的方法的有效性，我们在从不同平台收集的六个公开数据集上进行了广泛的实验。相应的统计数据总结于表 1 中。
(1) ml-1m 是从 MovieLens 网站收集的电影评分数据集。
(2) a-arts/-music/-video：这些数据集是来自亚马逊评论数据集 [16] 的三个子类别（艺术、工艺品和缝纫/数字音乐/视频）。
(3) steam 是从 Valve Steam [11] 爬取的，其中包含游戏信息和相应的评论。
(4) Retailrocket 包含六个月内与电商网站相关的用户浏览活动的集合。
参照 [36]，我们按用户或会话对记录进行分组，并按时间升序排序。同时，我们对所有数据集采用 5 核策略，以过滤掉记录少于 5 条的不活跃用户和不受欢迎的商品。

4.1.2
评估指标。遵循[33]，我们采用广泛使用的top-k指标，包括命中率(HR)、归一化折扣累积增益(NDCG)和平均倒数排名(MRR)进行准确率评估。值越高，表示所有指标的性能越好。
全排序协议会计算这些指标，并将真实项目与所有候选项目进行排序。

为了评估能耗，我们量化了不同网络结构各个部分在硬件层面的浮点运算（FLOP）总量。通过假设
各种运算使用的数据是32位浮点im-
在45nm技术芯片中实现[9]，其中𝐴�𝐴�𝐴𝐴� = 4.6𝐴�𝐴�
和 𝐴�𝐴𝐴� = 0.9𝐴�𝐴�，然后我们可以估计平均总能量
某些模型根据一批序列样本推断下一个项目的成本。 附录 A 详细说明了计算
进行推荐推断的能源成本。

4.1.3
脉冲基线。根据网络架构的类型，我们选择了以下最先进的模型作为下游SR任务的骨干模型，并将它们与相应的SNN变体进行比较：（1）GRU4Rec [8] 利用循环结构 (GRU) 对项目序列进行建模；（2）SRGNN [24] 将会话中的项目序列转换为图结构数据，并使用软注意力机制对序列行为进行建模；（3）SASRec [11] 是一个基于 Transformer 的SR模型；（4）Caser [20] 利用水平和垂直卷积运算来捕捉用户偏好；（5）FMLP [36] 是一个最近的基准模型，它将快速傅里叶变换 (FFT) 与 Transformer 结构相结合，以增强序列信息的提取。上述五个模型的SNN变体分别为SGRU4Rec、
SRSGNN、SFSRec、SCaser和SFMLP。附录B详细说明了这些模型名称的含义。

4.1.4
实施细节。我们使用时间感知和用户级的按比例分割策略 [19] 来分割整个数据集，其中序列数据的最后 20% 子集作为测试集。为了进行公平比较，所有基线均可通过我们的 SSR 流程复现。
在本研究中，我们将批次大小设置为 128，训练周期数设置为 25。此外，所有与基于 ANN 的基线相关的超参数均使用树结构 Parzen 估计器 (TPE) 策略 [3] 在 20 次试验内搜索。考虑到能耗的公平比较，基于 SNN 的方法将与其相应的 ANN 原型共享相同的超参数设置，以确保相同的架构规模。同时，我们假设其他固定部分的能耗相等，并仅比较相应模型的修改部分。附录 C 详细说明了每个主干算法的超参数设置的搜索范围以及最佳设置的值。


# 4.2 Complexity Analysis
在本节中，我们将从推理时间复杂度的角度比较五种脉冲 SR 模型（SCaser、SGRU4Rec、SRSGNN、SFSRec 和 SFMLP）。这些脉冲方法代表了不同的神经架构范式，其时间复杂度由三个因素决定：感受野的长度 𝐴�、脉冲神经元的总时间步长 𝐴� 以及嵌入潜在因子的维度 𝐴�。

具体来说，SCaser 通过大量水平和垂直卷积块来捕捉用户偏好，其复杂度分别为
O(𝐴� 𝐴�(1+𝐴�)
2
𝐴�2) 和 O(𝐴�𝐴�𝐴�2)。此外，加上最后一个全连接部分的复杂度（时间成本为 O((𝐴�𝐴�2 + 𝐴�2)），SCaser 的总时间复杂度为 O(𝐴�𝐴�2𝐴�2)。
根据公式 (8)-(11)，SGU 以序列长度 𝐴� 进行迭代，SGU4Rec 的总时间复杂度为 O(𝐴�𝐴�2)。
类似地，SRSGNN 采用门控机制对会话图进行建模，因此门控 GNN 编码器部分的时间成本为 O(𝐴�2𝐴� + 𝐴�𝐴�2)。加上剩余的解码器部分，SRSGNN 的最终时间复杂度等于 O((𝐴�2𝐴� + 𝐴�𝐴�2) + (𝐴�𝐴�𝐴�2))。在基于 Transformer 的方法中，特征提取器需要计算项目对之间的相似度。具体而言，公式 (12)-(15) 中描述的 SSA 的时间复杂度为 O(𝐴�𝐴�𝐴�2)，而 SFMLP 中的快速傅里叶变换运算的时间复杂度为 O(𝐴� log 𝐴�)。具体而言，SCaser 通过多个水平和垂直卷积块捕获用户偏好，其复杂度分别为
O(𝐴� 𝐴�(1+𝐴�)
2
𝐴�2) 和 O(𝐴�𝐴�𝐴�2)。此外，加上最后一个全连接部分的复杂度（时间成本为 O((𝐴�𝐴�2 + 𝐴�2)），SCaser 的总时间复杂度为 O(𝐴�𝐴�2𝐴�2)。
根据公式 (8)-(11)，SGU 以序列长度 𝐴� 进行迭代，SGU4Rec 的总时间复杂度为 O(𝐴�𝐴�2)。
类似地，SRSGNN 采用门控机制对会话图进行建模，因此门控 GNN 编码器部分的时间成本为 O(𝐴�2𝐴� + 𝐴�𝐴�2)。加上剩余的解码器部分，SRSGNN 的最终时间复杂度等于 O((𝐴�2𝐴� + 𝐴�𝐴�2) + (𝐴�𝐴�𝐴�2))。在基于 Transformer 的方法中，特征提取器需要计算项目对之间的相似度。具体而言，公式 (12)-(15) 中描述的 SSA 的时间复杂度为 O(𝐴�𝐴�𝐴�2)，而 SFMLP 中的快速傅里叶变换运算的时间复杂度为 O(𝐴� log 𝐴�)。两者

## 4.3 Performance Evaluation
4.3.1
预测准确率。表3显示了不同基线在数据集上的结果。SNN与ANN在不同情况下的性能通常相当，在HR@10、MRR@10和NDCG@10上的平均损失分别为5.59%、5.48%和5.49%。这表明脉冲式修改有望保持模型在捕获有用特征方面的有效性。此外，影响最终推荐性能的主要因素是网络结构，而不是网络类型。这两种基于Transformer的方法在大多数数据集上的表现都优于其他方法。一种解释是，这些Transformer结构具有更多参数，可以从简单的序列特征中提取复杂信息。我们还发现，在某些情况下，基于GNN的方法优于其他方法。由于GNN采用高维方式重构商品序列的空间特征，因此有时这种方法可以有效提升推荐效果。虽然基于RNN的模型（与GRU相关）并非性能最佳的方法，但它们在大多数情况下往往能取得不错的效果，这表明循环方法适合用于捕捉序列模式。此外，基于CNN的模型在大多数情况下表现不如其他方法。对于Caser，在不同数据集上，最高MRR@10与其自身值之间的平均差距为17.44%。对于SCaser，差距更大，达到20.78%。这意味着与其他网络结构相比，扩展卷积窗口方法无法精确捕捉商品的序列特征。

最后，图 4 中的模式展示了各种基于 SNN 的方法在不同数据集上的最终性能表现出的高度一致性和稳定性。所有这些观察结果都验证了我们提出的脉冲模型对于 SR 是有效的。

We summarize these analyses above as finding 1:
发现 1：对于基于 ANN 和基于 SNN 的模型，网络架构的设计最终决定了推荐的准确率。此外，不同的基于 ANN 的原型及其对应的基于 SNN 的变体之间的性能保持一致，并且脉冲式修改引起的损失差距可以忽略不计。

4.3.2
设备能耗。表 4 展示了三对基于 ANN 和基于 SNN 的基线模型在不同场景下的能耗差异（GNN 和 FFT-transformer 的结果见附录 E）。在本次比较中，我们仅评估了脉冲修改组件的能耗差异，假设未修改部分的能量消耗一致。通过观察，我们得出结论：与基于 ANN 的方法相比，基于 SNN 的模型在能效方面表现出显著优势，最高节能率可达 97.30%。这一发现阐明了引入 SNN 对增强边缘设备可持续性的有效性。此外，基于 CNN 和基于 Transformer 的方法的平均节能率分别低于基于 RNN 的模型约 1.06% 和 2.31%。大量层归一化操作的计算复杂度仍然是能耗成本的主要因素，这表明混合模型与基于 CNN 的模型在能耗方面的差距计算结构和纯SNN结构，突出了潜在的优化途径。最后，与ANN不同，ANN的推理能耗成本与内部计算参数的数量呈正相关，而基于SNN的模型有时可能对某些数据集场景表现出较高的敏感性。例如，SCaser在蒸汽上消耗的能耗比在视频上高7.47倍，而相应的项目嵌入维度减少了17倍。总而言之，能耗成本比较如下：

发现2：SNN的节能优势使其在SR任务中保持了有效性。更多脉冲式修改可带来更高的能效。然而，与基于ANN的原型不同，基于SNN的变体的总能耗成本与模型规模并不成正比。


## 4.4 多模态信息的有效性
受 [10] 的启发，我们将 clip-vit-base-patch32 和 bert-base-uncased 集成到服务器上的特征提取器中。这使得能够提取与特定历史商品序列相关的通用视觉和文本信息。随后，所有信息将被输入到特征转换模块，该模块将模态信息与序列标记信息一起转换为适合进一步 SR 任务的语义空间。

表 5 中的观察结果表明，对于 HR@10 和 NDCG@10，基于多模态边信息特征的 SNN 模型优于仅包含一般 ID 信息的模型，在三个选定的数据集上，其提升幅度分别为 7.36%-26.61% 和 7.20%-38.75%。此外，不同模型对不同数据集的边信息表现出不同的敏感度。虽然基于这两个指标，SFMLP 在所有仅包含商品 ID 信息的场景下都优于 SFSRec，但值得注意的是，在 a-music 案例中，在整合相关评论和图像特征后，HR@10 和 NDCG@10 的 SFSRec 的提升率分别超过 SFMLP 6.16% 和 14.54%。这些结果表明，SNN 方法仍然具有整合上游提取特征以提升下游推荐质量的潜力，可以进一步得出结论：

发现 3：基于 SNN 的方法保留了处理
来自异构数据源（如 ANN）的辅助信息的能力，
这使得它们也适合作为多模态信息增强的主干 SR 算法。

## 4.5 Sensitive Analysis on SNN
4.5.1
时间步长。SNN 有一个不可忽略的超参数，称为时间步长𝐴�，它决定了整个网络的计算复杂度。在本部分中，我们通过观察两种相对有效的基于 Transformer 的 SNN 算法在两个数据集上在不同时间步长下的性能指标变化，探索时间步长与模型性能之间的关系。

图 5 和表 6 所示的结果表明：（1）每增加一个时间步长，训练时间成本都会大致等量增加（例如，在 steam 上使用 sfsrec 时，每增加一个时间步长，训练时间就会增加约 50 秒）。（2）节能率不仅取决于脉冲输入的时间步长。其他因素，例如特征提取的内部逻辑，也会影响能耗。例如，SFMLP 中的复数 FFT 部分比前馈部分消耗更多的计算资源。因此，与 SFSRec 相比，随着时间步长的增加，整体节能率略有下降。（3）准确率的轻微提升与增加的能耗和训练时间成本无法相比。因此，对于进一步的基准实验，相对较小的时间步长 𝐴� = 4 是合理的，我们推断：

发现 4：较大的时间步长并不能显著提高基于 SNN 的算法的性能，反而会削弱能效优势并增加训练成本。

4.5.2
序列长度。项目序列的长度决定了SR任务的复杂度。长项目序列引入的高阶序列依赖关系对模型准确捕捉用户偏好构成了挑战。因此，应该进行类似的实验来评估当前基于SNN的方法在序列长度变化时的鲁棒性。图6展示了基于SNN的模型的准确率性能，在不同长度的序列中表现出轻微的差异。此外，与脉冲变换器相比，FFT变换器在处理较长序列长度的任务时可能更有效，这表明注意力机制在捕捉长序列中项目之间的依赖关系方面存在局限性。
简而言之，我们发现了发现5：

发现 5：基于 SNN 的方法非常稳健，并且有潜力解决长序列推荐问题。


# 5 RELATED WORK
设备端顺序推荐。近期关于顺序推荐 (SR) 的研究 [8, 20, 23, 24, 36] 已在各种数据集上取得了基准性能。然而，这些算法都是为云/服务器平台设计的，无法满足用户在智能手机等手持设备上进行本地推理的需求。设备端 SR 因其低能耗/资源消耗和良好的性能而受到越来越多的关注。其重点领域之一是部署和推理任务 [32]，旨在在资源受限的设备上部署和实现轻量级模型，从而缓解资源消耗和推理延迟问题。特别是，组合嵌入方法和模型压缩技术已成为部署和运行设备端 SR 系统的主流 [12, 22, 26, 27]，因为它们通过权重共享和复杂度降低有效地减少了参数总量。
一些研究还探讨了模型可持续性的问题，因为由于边缘设备的计算和存储能力有限，以及用户交互的不断发展，压缩模型的鲁棒性无法及时更新 [28, 31]。

尽管这些方法有效，但它们的内部计算单元仍然依赖于浮点运算，并且这些研究中使用的实验平台主要依靠电池供电，因此忽略了与设备寿命相关的问题。在现实世界的设备端场景中，手机和智能手表等边缘设备均由电池供电。在这种情况下，设备的可持续性变得至关重要。在保持相对准确的推荐性能的同时延长设备使用时间可以提升用户体验并增加应用程序的盈利潜力，这促使我们利用SNN（一种适用于边缘设备的节能架构）来开发下游SR算法。

脉冲神经网络在推荐系统中的应用。脉冲神经网络 (SNN) 以其节能和生物保真度高的特点，使其成为解决计算和能源约束问题的一种有前景的途径。近期对 SNN 的研究已在各个领域取得了显著成功 [13, 30, 37]，这激励着研究人员探索 SNN 在更多领域的兼容性。
一些研究人员开始深入研究将 SNN 集成到推荐系统中的可行性 [1, 14, 38]。这些研究尝试将原始特征或来自特征提取器（例如图）的输出转换为脉冲信号，并将其应用于原始的协同过滤模型，以增强推荐性能。此外，很少有研究证明 SNN 机制在 SR 任务中的有效性 [2]，并且还没有一个标准化框架来全面评估 SNN 和 ANN 在 SR 任务中的准确性和能耗性能。
因此，当前的研究形势促使我们开发一个全面的工具包，以便公平、准确地比较最先进的 SR 算法及其相应的基于 SNN 的变体，并考虑两个因素——准确度和能耗。

# 6 CONCLUSION
在本文中，我们指出了电池供电的边缘设备在进行SR推理时存在的可持续性问题。为了解决这个问题，我们利用基于神经形态芯片的节能神经网络SNN，通过延长设备使用时间并保持推荐准确率来提升用户体验和对推荐多媒体内容的参与度。大量的实证研究结果证明了我们提出的方法在实际推荐工作流中令人信服的性能和有效性。
虽然目前整合额外信息的方法比较简单，但其性能提升为后续探索更先进的多模态辅助信息融合方法提供了参考。由于缺乏有效的基准测试，我们提出了一个名为SSR的工具包，用于公平、严格地评估设备端SR系统算法的准确率和能耗。尽管SSR中的某些SNN模型是混合架构，但我们仍将其作为未来研究的参考，从而扩展SNN在设备端SR任务中的应用。