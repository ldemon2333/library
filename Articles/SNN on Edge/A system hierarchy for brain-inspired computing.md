# Abstract
神经形态计算从大脑中汲取灵感，为计算技术和架构提供了推动下一波计算机工程浪潮的潜力。这种受大脑启发的计算也为人工智能的发展提供了一个有前途的平台。然而，与传统计算系统不同，传统计算系统具有围绕图灵完备性和冯诺依曼架构概念构建的完善的计算机层次结构，而目前还没有针对脑启发计算的通用系统层次结构或对完整性的理解。这会影响软件和硬件之间的兼容性，从而削弱脑启发计算的编程灵活性和开发效率。在这里，我们提出了“神经形态完整性”，它放宽了对硬件完整性的要求，以及相应的系统层次结构，它由图灵完备的软件抽象模型和多功能抽象神经形态架构组成。使用这种层次结构，各种程序都可以被描述为统一的表示，并转换为在任何神经形态完整硬件上可执行的等效程序——也就是说，它确保了编程语言的可移植性、硬件完整性和编译可行性。我们实现了工具链软件来支持在各种典型硬件平台上执行不同类型的程序，展示了我们系统层次结构的优势，包括神经形态完整性引入的新系统设计维度。我们期望我们的研究将使受脑启发的计算系统的各个方面取得高效和兼容的进展，促进包括人工智能在内的各种应用的开发。

脑启发计算是一种计算模型和架构，它有可能打破冯·诺依曼瓶颈并推动下一波计算机工程。脑启发计算系统已用于人工智能，并可能为通用人工智能提供一条途径。脑启发计算在人工智能以外的更通用算法中的应用也已被探索。所有这些应用都对脑启发计算系统的性能、可编程性和生产力提出了挑战。

各种用于脑启发计算的算法、计算模型和软件设计正在涌现。尽管已经提出了许多神经形态芯片[5-14]，但它们通常需要特定的软件工具链[22-25]。因此，脑启发计算系统的多个层次（包括应用程序模型、系统软件和神经形态设备）被绑定在一起，损害了编程灵活性和开发效率。一些研究试图通过领域特定语言[26]或开发框架[19,20,27]来连接各种软件和硬件，但这些研究通常不考虑完整性或隐含地依赖于图灵完整性。很少有工作来解决更基本的问题，例如硬件完整性、编程语言完整性和脑启发计算的广义系统层次结构。

现有的计算机层次结构，例如图灵机 [16] 和冯·诺依曼体系结构 [17,18]，提供了对这些问题对于计算系统的重要性的洞察（补充信息第 1 部分）。几乎所有现有的编程语言都是图灵完备的（即，它们具有与通用图灵机相同的功能），而冯·诺依曼抽象体系结构通过图灵完备接口（即通用指令集）支持图灵机。==通过引入图灵完备性以及基于图灵完备性和冯·诺依曼体系结构的层次结构，避免了当前计算系统中软件和硬件之间的紧密耦合，从而实现了高效、兼容和独立的进步。==通过设置硬件的最低要求（图灵完备性），可以将任何高级语言程序转换为任何冯·诺依曼处理器上的等效指令序列（编译）。

相比之下，类脑计算目前缺乏一个简单但完善的系统层次来支撑整体发展[28]。因此，神经形态软件和硬件之间没有清晰完整的接口，不同研究方面之间的相互作用很复杂[29]。此外，由于许多类脑芯片不是为通用计算而设计的，而且很少有芯片提供传统的指令集，因此尚不清楚它们是否是图灵完备的，甚至图灵完备是否是必要的。

图灵完备性是传统编译的可行性基础，要求程序表达和转换的等价性。相比之下，脑启发系统具有独特的属性，例如**近似**（脑启发系统通常遵循神经网络的计算模型来模仿生物神经网络的行为或特征）[30–32]。例如，对于许多脑启发芯片，包括早期的神经启发芯片[33]和当代的脑启发系统[5–14]，近似是一种实现低功耗和高性能的方法，使用低精度数字计算[5,6,8–10,14]或模拟电路[7,11–13,33–38]实现。因此，我们提出了*神经形态完备性*，这是脑启发计算的更具适应性且更广泛的完备性定义。它放宽了对神经形态硬件的完整性要求，可以提高不同硬件和软件设计之间的兼容性，并通过引入新的维度，即***近似**粒度*来扩大设计空间。

神经形态计算与传统计算[2]的不同之处还在于它使用共置计算和存储，使用基于脉冲[39]（脉冲神经网络的特征）的事件驱动计算，并且具有更高的高并行性潜力等。这些差异使得传统的计算机层次结构难以直观地描述受脑启发的应用程序并有效地执行它们。因此，我们进一步提出了一种具有高度通用性和普遍性的受脑启发计算的系统层次结构。该层次结构有三个级别：软件、硬件和编译。

# Software
软件是指编程语言或框架，以及基于这些语言或框架构建的算法或模型。在这个层面上，我们提出了一个统一的通用软件抽象模型——编程操作符图（POG），以适应各种脑启发算法和模型设计。==POG由统一的描述方法和集成存储和处理的事件驱动的并行程序执行模型组成。它描述了什么是脑启发程序，并定义了如何执行它。==由于POG是图灵完备的，因此它最大程度地支持各种应用程序、编程语言和框架。

# Hardware
硬件包括所有脑启发芯片和架构模型。我们设计了抽象神经形态架构 (ANA) 作为硬件抽象。它包括一个执行原语图 (EPG) 作为上层的接口，以描述它可以执行的程序。EPG 具有混合控制流-数据流表示，这最大限度地提高了它对不同硬件的适应性，并与有前途的硬件趋势——混合架构 [3,4] 相一致。

# Compilation
中间层负责将程序转换为硬件支持的等效形式。为了实现可行性，我们提出了一套主流类脑芯片广泛支持的硬件执行原语，并证明了配备这套原语的硬件是神经形态完备的。我们还实现了一个工具链软件作为编译层的实例，以证明该层次结构的可行性、合理性和优势。

通过这种层次结构，我们避免了硬件和软件之间的紧密耦合，确保任何受大脑启发的程序都可以用图灵完备的 POG 表示，然后在任何神经形态完整硬件上编译成等效且可执行的 EPG（图 1）。我们还确保了受大脑启发的计算系统的编程可移植性、硬件完整性和编译可行性。我们提出的实验证明了神经形态完整性引入的系统设计维度的优化效果。此外，我们认为我们的层次结构有助于软件硬件协同设计。
![[Pasted image 20241225143052.png]]
图 1 | 类脑计算系统与传统计算系统的层次结构。受传统计算系统层次结构（右）的启发，我们提出了一个类脑计算系统层次结构（左），它也有三个层次：软件（顶部）、编译器（中间）和硬件（底部）。在传统计算系统层次结构中，软件层是指各种应用程序和图灵完备的编程语言（如 JAVA 和 Python）。在编译过程中，软件的中间表示（如抽象语法树）将转换为硬件的中间表示（如指令）。在硬件层，指令在遵循冯·诺依曼架构的中央处理单元 (CPU) 或图形处理单元 (GPU) 上运行。冯·诺依曼架构包括算术和逻辑单元 (ALU)、控制单元、内存、输入和输出。不同层之间的精确等价性由图灵完备性保证。对于脑启发计算系统层次结构，软件层指的是神经形态应用程序和开发框架（例如 Nengo 和 PyTorch）。 相应地，我们提出 POG 作为软件的中间表示，EPG 作为硬件的中间表示（CFG，控制流图）。 引入编译工具将 POG 转换为 EPG。 对于硬件层，我们提出了 ANA，它包括调度单元（SU）、处理单元（PU）、内存和互连网络作为神经形态硬件的抽象（TrueNorth、SpiNNaker、Tianjic 和 Loihi）。 考虑到脑启发计算的近似特性，我们进一步提出了神经形态完备性的概念，除了精确等价之外，还引入了近似等价。

# Neuromorphic completeness
对于任何给定的误差间隙 ε ≥ 0 和任何图灵可计算函数 f(x)，如果一个计算系统能够实现一个函数 F(x)，使得对于任何有效输入 x，‖F(x) − f(x)‖ ≤ ε，则称该计算系统是==神经形态完整==的（补充信息第 2 部分）。

神经形态完备性用于衡量神经形态计算系统的兼容性。==它将完备性的要求从使用算法精确计算函数放宽到近似计算。==计算机科学术语中的算法是由图灵机定义的计算过程。因此，使用算法计算函数意味着系统模拟图灵机，然后使用该算法实现该函数。相比之下，通过近似实现函数不需要这样的计算过程。

神经网络的逼近能力由通用逼近定理 [40] 定义。只有一个隐藏层的多层感知器可以很好地逼近任何函数。它通过记忆函数的映射来逼近函数。另一方面，模拟图灵机需要诸如递归和控制流之类的机制来实现任意数量的状态转换。具有一个隐藏层的多层感知器在输入和输出之间只有两个转换；因此，它不是图灵完备的。然而，多层感知器和图灵完备系统都是神经形态完备的。

本质上，神经形态完备性将通用近似与通用可计算性联系起来。它为将图灵完备程序转换为神经形态完备系统上的等效程序的可行性奠定了理论基础，拓宽了完备硬件的范围。此外，由于神经形态完备性与近似和精确计算兼容，它扩展了脑启发系统的设计空间。

# System hierarchy
在 POG（图 2a，补充信息第 3 节）中，程序被定义为一个有向图，其中每个节点都是一个运算符，边描述不同运算符的优先关系。运算符执行实际计算，并在收到所有输入事件时触发执行；也就是说，POG 是事件驱动的。此外，运算符仅包含处理本地存储和外部输入的操作。因此，这些操作本质上适合集成内存和计算的处理模式。
![[Pasted image 20241225144002.png]]
![[Pasted image 20241225145007.png]]

POG 极大地扩展了纯数据流活动模型 [41,42]（补充信息第 3.6 节），同时继承了其对细粒度并行性的支持。POG 是图灵完备的（补充信息第 3.5 节，补充图 1）。因此，它也可以被视为各种脑启发应用的基础编程语言，并且与现有的脑启发框架兼容 [19,20,26,27]。POG 提供专用运算符（扩展数据图 1，补充信息第 3.3 节），帮助用户更轻松地描述脑启发计算操作并提供更多性能提示。POG 的另一个特点是可组合性（补充信息第 3.4 节）。我们可以将 POG 的任何部分定义为新运算符，同时保持其余部分不变，只要它受底层硬件支持即可。这使得描述复杂模型成为可能，并有利于软件硬件协同设计（补充信息第 10.2 节）。

ANA（补充信息第 6 节）包含大量处理单元，每个处理单元都与私有内存和调度单元共置。处理单元提供硬件执行原语，这些原语并行执行主要计算，并由调度单元调度。所有这些单元都通过互连网络进行通信。ANA 是一种逻辑设计，可灵活适应不同的硬件实现（图 2c）。例如，处理单元可以通过忆阻器交叉开关 [34-37] 或通用处理器来实现。因此，ANA 能够实例化为几个众所周知的神经形态芯片（补充信息第 6.1 节，补充图 3）。

ANA（EPG）的接口是混合控制流-数据流两层图（图 2b，补充信息第 4 节，补充图 2）。第一层是控制流图，其中每个节点都是包含一个或多个执行原语的基本块，有向边表示从一个基本块跳转到另一个基本块。第二层是根据每个基本块内的数据依赖关系由执行原语形成的数据流图。

# Basic execution primitives
基本执行原语集（补充信息第 4.1 节）包含两种类型的计算原语，就像多层感知器一样：加权和运算和逐元素整流线性单元运算。这些原语通常适用于主流的脑启发芯片；例如，支持泄漏积分和发射模型的芯片也可以被认为提供两个原语（补充信息第 4.2 节）。我们提供了一个建设性的证明，即具有基本执行原语的 EPG 是神经形态完整的（补充信息第 4.3 节）。该证明还为构建可以将任何图灵完备 POG 转换为等效 EPG 的相应编译器提供了方向。

此外，具有该基本集的 EPG 是一个理想的例子，表明神经形态完备性将通用近似与通用可计算性联系起来。一方面，通用近似器可以表示为 EPG 的一个极端实例：第一层控制流图退化为只有一个块，其中包含一个近似整个程序的多层感知器。另一方面，如果我们使用基本执行原语来精确实现一些基本操作（例如布尔函数），并使用这些基本操作来组成更复杂的计算和控制流模式，那么以这种方式构建的 EPG 就是图灵完备的（现代数字计算机基于确定性布尔电路）。在这两个极端之间，EPG 可以表示为具有不同近似粒度的各种形式（图 2d），在性能和资源消耗之间有不同的权衡。

# Toolchain, applications and experiments
我们根据层次结构为工具链软件构建了一个框架，该框架由两部分组成：==编译器和映射器==。编译器（补充信息第 5.1 节）将 POG 转换为等效的 EPG。如图 3b 所示，编译器首先将 POG 中的运算符拆分或合并到适当的近似粒度。然后，使用遵循上述 EPG 神经形态完整性的建设性证明的方法近似执行原语无法精确实现的所有运算符（使用“模板匹配”确定）。有几种优化技术可以减少生成的 EPG 的资源消耗（补充信息第 5.2-5.5 节）。==映射器（补充信息第 7 节，图 3c，补充图 4）尽可能高效地将生成的 EPG 部署到硬件，同时满足硬件约束。我们实现了一个工具链实例（方法，补充信息第 8 节），它可以将各种应用程序转换为统一的、独立于硬件的中间表示（POG），==并在映射之前将每个 POG 编译为特定于目标的执行原语的 EPG。
![[Pasted image 20241225145711.png]]
目前支持三种硬件平台，均为典型的神经形态完备系统：（1）通用图形处理单元（GPU），一种脑启发式芯片；（2）天机[14]；（3）基于忆阻器的深度神经网络加速器FPSA[36]。通用GPU是传统的图灵完备系统，完全依赖于精确计算。FPSA提供高效、高密度的基本执行原语，主要通过近似实现不同的功能。天机同时支持精确计算和近似计算。

我们针对三种应用进行了实验，以证明层次结构的可行性和多功能性，以及神经形态完整性引入的设计权衡（方法）。第一个应用是用于自行车驾驶和跟踪的混合脉冲-人工神经网络模型[14]。它包含五个神经网络，每个神经网络都是不同类型的（图 3a，补充信息第 9.1 节）。在编译之前，每个神经网络的 POG 在不同的硬件平台上都是相同的。近似误差设置为零；也就是说，在这个实验中，所有三个平台的行为都相同。三个平台的性能和面积消耗如图 3d 所示。由于 FPSA 通过近似实现功能，因此近似粒度的选择对硬件成本有很大影响（图 3e）。

第二个应用是用于鸟群模拟的 boids 模型 [43]。这是一个非神经网络应用，需要许多非线性张量计算（图 4a，补充信息第 9.2 节）。工具链可以在三个平台上支持它；运行性能和成本如图 4b 所示。图 4c 说明了此应用程序在不同近似误差下的行为。误差越大（通常意味着硬件开销越小），与精确计算行为的差异就越大。由于该模型的混沌性，由于近似误差有限，因此可以保持鸟群运动的属性。该实验表明，通过利用相关的近似，我们的提案的应用范围扩展到非神经网络。

第三个应用是 QR 分解，一种常见的数学算法（补充信息第 9.3 节）。它需要各种非线性计算，这对一些受大脑启发的平台来说是一个挑战。我们使用通用近似器来实现图 4d 所示的所有计算（其他是线性的，可以精确计算）。近似器可以覆盖一个或多个连续步骤（不同的近似粒度），从而导致多种近似策略。因此，我们使用融合空间网络（图 4e）直观地表示策略空间，并使用启发式搜索方法作为优化策略（图 4f、g）。该实验进一步证明了我们的提议支​​持任意应用。它还表明，只要满足某些错误限制，神经形态完整性引入的近似粒度和性能之间的权衡有利于降低硬件成本。

# Conclusion
我们提出了脑启发系统的完备性定义，拓宽了完整硬件的范围，并引入了系统设计的新维度，即近似粒度。结合所提出的系统层次结构（包括软件和硬件抽象模型），完备性的扩展定义实现了图灵完备软件和神经形态完备硬件之间的等效转换；也就是说，它将软件和硬件分离。我们的设计理念使系统不同方面之间的接口和划分更加清晰，这可能有助于多学科研究。我们希望进一步致力于这一基本层次结构，以提高脑启发计算开发的生产力[44]，包括人工智能的发展（补充信息第 10 节）。