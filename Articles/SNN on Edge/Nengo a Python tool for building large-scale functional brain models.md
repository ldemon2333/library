目前，神经科学缺乏关于如何在生物基质中实现认知过程的全面理论。神经工程框架 (NEF) 提出了这样一种理论，但尚未获得大量实证支持，部分原因是使用 NEF 构建和模拟大型模型的技术挑战。==Nengo 是一种软件工具，可用于基于 NEF 构建和模拟大型模型==；目前，它是教授如何使用 NEF 以及进行生成特定 NEF 模型来解释实验数据的研究的主要资源。Nengo 1.4 是用 Java 实现的，用于创建世界上最大的功能性大脑模型 Spaun（Eliasmith 等人，2012 年）。模拟 Spaun 凸显了 Nengo 1.4 在支持使用简单语法的模型构建、快速模拟大型模型以及收集大量数据以供后续分析方面的能力的局限性。本文介绍了用 Python 实现的 Nengo 2.0，它克服了这些限制。它使用简单且可扩展的语法，模拟 Spaun 规模的基准模型的速度比 Nengo 1.4 快 50 倍，并且具有灵活的模拟结果收集机制。

# 1. 介绍
模拟人类大脑是我们这个时代最大的科学挑战之一。计算神经科学取得了重大进展，从详细模拟低级生物部分到解决人类难以解决的高级问题；然而，我们仍然缺乏关于生物组件如何实现感知处理、记忆形成、推理和运动控制等认知功能的数学解释。人们在神经模拟器上投入了大量工作，试图以精确的细节重建神经科学数据，认为通过根据生物突触的统计数据连接详细的神经元模型，认知将会出现（Markram，2006）。然而，认知尚未从数据驱动的大规模模型中出现，有充分的理由认为认知可能永远不会出现（Eliasmith 和 Trujillo，2013）。另一方面，认知架构（Anderson 等人，2004 年；Aisa 等人，2008 年）和机器学习方法（Hinton 和 Salakhutdinov，2006 年）已经解决了高维统计问题，但这样做并没有尊重生物学限制。

Nengo 是一个神经模拟器，基于 Eliasmith 和 Anderson (2003) 提出的理论框架，称为神经工程框架 (NEF)。NEF 是一种大规模建模方法，可以利用单个神经元模型构建具有可证明认知能力的神经网络。近十年来，Nengo 和 NEF 已用于构建日益复杂的神经子系统 \[例如，路径整合 (Conklin 和 Eliasmith，2005 年)、工作记忆 (Singh 和 Eliasmith，2006 年)、列表记忆 (Choo 和 Eliasmith，2010 年)、归纳推理 (Rasmussen 和 Eliasmith，2014 年)、运动控制 (DeWolf 和 Eliasmith，2011 年)、决策 (Stewart 等人，2012 年)]，最近以 Spaun 达到顶峰，这是目前世界上最大的功能性大脑模型 (Eliasmith 等人，2012 年)。Spaun 是一个由 250 万个脉冲神经元组成的网络，可以执行八项认知任务，包括记忆列表和归纳推理。通过呈现代表要执行的任务的适当图像系列，它可以随时执行这八个任务中的任何一个；例如，按顺序呈现包含字符 A3[1234] 的图像指示 Spaun 记住列表 1234。如果要求回忆记忆的列表，Spaun 会为模拟手臂生成运动命令，写出数字 1234。虽然 Spaun 执行的任务多种多样，但所有任务都使用一组通用的功能性皮质和皮质下组件。每个功能组件都对应于神经科学文献中假设执行这些功能的大脑区域。

NEF 提供了指导神经模型构建的原则，该模型结合了解剖学约束、功能目标和动态系统或控制理论。从这个起点构建模型，而不是仅仅从单细胞电生理学和连接统计数据构建模型，可以产生模拟数据，解释和预测各种各样的实验结果。NEF 设计的模型的单细胞活动 (Stewart 等人，2012 年)、反应时间 (Stewart 和 Eliasmith，2009 年)、行为错误 (Choo 和 Eliasmith，2010 年) 和与年龄相关的认知衰退 (Rasmussen 和 Eliasmith，2014 年) 与生理和心理发现相符，而无需专门设计。这些结果是需要在解剖学和神经生物学约束内满足功能目标的结果。

NEF 的变换原理提出，两个神经群体之间的连接权重矩阵可以计算非线性函数，并且可以分解为两个明显较小的矩阵。通过使用这些因子代替全连接权重矩阵，NEF 设计的模型具有更高的计算效率，==这使得 Nengo 能够在低成本的商用硬件上运行大规模神经模型。==

为了使 Nengo 更简单、更可扩展、更快速，我们用 Python 从头重写了 Nengo 2.0，利用 NumPy (Oliphant, 2007) 来处理大量数据。虽然 NumPy 是其唯一的依赖项，但 Nengo 包含可选扩展，如果 Matplotlib 可用，则可用于绘图 (Hunter, 2007)，如果 IPython 可用，则可用于交互式探索 (Pérez and Granger, 2007)。由于 Nengo 仅依赖于一个第三方库，因此很容易将 Nengo 模型集成到任意 CPython 程序中，从而为在 Web 服务、游戏和其他应用程序中使用神经实现的算法开辟了可能性。

Nengo 2.0 有一个简单的对象模型，这使得它易于记录、测试和修改。模型创建和模拟是分离的，允许模型与其他模拟器一起运行，作为 Nengo 2.0 平台独立参考模拟器的替代品。到目前为止，我们已经实现了另一个使用 PyOpenCL（Klöckner 等人，2012 年）的模拟器，以利用 GPU 或多核 CPU。OpenCL 模拟器可以使用廉价的商用硬件模拟 Spaun 规模的大型模型，速度至少比 Nengo 1.4 快 50 倍。

总之，Nengo 2.0 提供了一个模拟比 Spaun 更大、更复杂模型的平台，因此可以进一步测试 NEF 作为神经计算理论。

# 2. NEURAL ENGINEERING FRAMEWORK (NEF)
神经工程框架 (NEF；Eliasmith 和 Anderson，2003) 提出了三项定量指定的原则，这些原则使得能够构建大规模神经模型。简而言之，这个数学理论定义：
- Representation: A population of neurons collectively represents a time-varying vector of real numbers through non-linear encoding and linear decoding.
- Transformation: Linear and non-linear functions on those vectors are computed by linear decodings that are used to analytically compute the connections between populations of neurons.
- Dynamics: 神经群体所表示的向量可以被视为（线性或非线性）动态系统中的状态变量，并且可以使用原理 2 来计算循环连接。

Nengo 是一个用于构建神经网络模型的开源工具，特别适用于模拟和实现生物启发式神经网络。Nengo 的核心目标是帮助研究人员和工程师构建可扩展的神经网络模型，进行神经科学、人工智能和机器学习领域的研究与应用。

它的主要特点包括：

1. **神经元模型：** Nengo 提供了不同的神经元模型（如 LIF 神经元、扩展 LIF 神经元等），可以用于构建生物学上启发的神经网络。
    
2. **网络构建：** Nengo 允许用户通过图形化界面或 Python 编程语言定义神经网络的结构，支持神经元、突触连接和信号传递的定义。
    
3. **模拟：** Nengo 可以高效地模拟神经网络的动态行为，支持各种神经元模型和突触的连接模式，同时可以在多种硬件上运行，包括 CPU 和 GPU。
    
4. **神经科学应用：** Nengo 被广泛应用于神经科学的研究中，帮助理解和模拟大脑神经元的工作方式。
    
5. **NengoDL 与 NengoGUI：** Nengo 还提供了 NengoDL（用于深度学习模型的接口）和 NengoGUI（用于可视化和交互操作的图形界面）等扩展工具。
    

Nengo 通过允许用户定义大规模神经网络，并在高效的模拟环境中进行仿真，帮助研究者探索神经网络的理论，尤其是在脑机接口、神经计算和人工智能领域的应用。

