神经形态硬件是新一代非冯·诺依曼计算系统，它将脉冲神经元和突触实现为基于脉冲神经网络 (SNN) 的应用。节能特性使神经形态硬件适用于物联网 (IoT) 传感器和边缘节点工作的功率受限环境。将 SNN 映射到神经形态硬件上具有挑战性，因为未优化的映射可能会导致高片上网络 (NoC) 延迟和能耗。在本文中，==我们提出了一种简单快速的工具链 NeuMap，用于将 SNN 映射到多核神经形态硬件上。NeuMap 首先通过计算获得 SNN 的通信模式，从而简化映射过程。然后，NeuMap 利用局部连接，将相邻层划分为子网络，并在满足硬件资源约束的同时将每个子网络划分为多个集群。最后，我们采用元启发式算法在缩小的搜索空间中搜索最佳的集群到核心映射方案。我们使用六个真实的基于 SNN 的应用程序进行实验，以评估 NeuMap 和两个先前的工作（SpiNeMap 和 SNEAP）。实验结果表明，与 SpiNeMap 和 SNEAP 相比，NeuMap 分别将平均能耗降低了 84% 和 17%，并将脉冲延迟降低了 55% 和 12%。==

# 1. 介绍
物联网 (IoT) 是一种新兴的计算范式，它通过无线网络集成了各种传感器。传统的物联网将传感器收集的数据传输到云端。然而，随着物联网设备数量的增加，由于各种原因，例如物联网网络上的大量工作量、延迟和隐私问题，在云端集中处理收集的数据变得困难 [1]。边缘计算将数据处理从云端转移到靠近传感器的边缘节点。传感器收集的数据可以在本地处理，也可以在本地预处理后传输到云端。人工神经网络 (ANN) 已部署在物联网设备上，以执行语音识别和验证等特殊任务 [2]。然而，传统 ANN 的密集内存和处理要求使得难以将深度网络部署到资源受限和功率受限的物联网设备上。

脉冲神经网络 (SNN) 被称为第三代神经网络，已被引入许多应用领域，包括心电图心跳分类 [3]、物体识别 [4]、波形分析 [5]、气味数据分类 [6] 和图像分类 [7]。SNN 具有有效处理时空信息的潜力。与 ANN 相比，SNN 具有功耗更低、计算量更小的特点。SNN 中的神经元通过跨突触发送脉冲来相互通信。脉冲神经元接受来自其突触前神经元的脉冲，并整合相应的权重以更新其膜电位。当神经元的膜电位达到发放阈值时，神经元会发放脉冲，然后膜电位被重置。

神经形态硬件是新一代受大脑启发的非冯·诺依曼计算系统，它有可能以比传统架构更少的内存占用、更高的能效和更快的速度执行复杂的计算。神经形态硬件实现了脉冲神经元和突触，这使得它们适合执行基于 SNN 的应用程序。最近，已经开发了许多神经形态处理器，例如 TrueNorth [8]、Loihi [9]、SpiNNaker [10]、Unicorn [11] 和 DYNAPs [12]。

Zhang 等人 [13] 提出了一种可扩展、经济高效且高速的 VLSI 架构来加速深度脉冲卷积神经网络 (SCNN)。神经形态硬件通常由多个核心组成，每个核心只能容纳有限数量的神经元。例如，TrueNorth 包含 4096 个神经突触核，单个核有 256 个轴突、256×256 突触交叉开关和 256 个神经元。为了支持核间通信，采用片上网络 (NoC) [14] 作为神经形态硬件中的互连机制。

==在神经形态硬件上执行 SNN 之前，应将 SNN 的神经元分配给目标神经形态硬件。此步骤通常分为两个子步骤。首先，将大规模 SNN 划分为多个簇，以使每个簇的神经元数量不超过单个神经形态核心的容量。其次，它选择适当的核心来执行分区的基于 SNN 的应用程序中存在的簇。

最近，已经提出了许多方法 [15–20] 来将基于 SNN 的应用程序映射到神经形态硬件上。PACMAN [15] 被提议将 SNN 映射到 SpiNNaker 上。Corelet [16] 是一种专有工具，用于将 SNN 映射到 TrueNorth。一些通用映射方法 [17–20] 采用启发式算法 [21–23] 将 SNN 划分为多个簇，目的是最小化分区簇之间的尖峰通信。分区后，他们使用元启发式算法 [21,24] 来搜索最佳簇到核心映射方案。

图 1 显示了某些现有 SNN 映射方法的高级概述。在分区阶段之前，这些方法需要使用 SNN 软件模拟器（例如 Brian2 [25] 和 CARLsim [26]）模拟 SNN，以统计方式获取通信模式（即所有神经元的脉冲时间）。在模拟之前，研究人员应该使用特定模拟器的应用程序编程接口 (API) 构建给定的 SNN，这对于不熟悉模拟器的研究人员来说可能具有挑战性。
此外，在软件模拟器上模拟大规模 SNN 会花费大量时间。模拟过程也包含在 PSOPART 和 NEUTAMS 中。

![[Pasted image 20241210173429.png]]

先前研究的第二个限制是，它们将 SNN 视为一个图，并直接将整个图划分为多个簇，而忽略了突触的特性。利用突触的特性可以进一步减少簇之间的脉冲通信。第三个限制是，它们总是在整个神经形态硬件中搜索最佳的簇到核心方案，这使得它们容易陷入局部最优。

在本文中，我们提出了一种将基于 SNN 的应用程序映射到神经形态硬件的有效工具链，==称为 NeuMap（用于边缘 AI 的脉冲神经网络到神经形态硬件的最佳映射）。==NeuMap 专注于具有前馈拓扑的基于 SNN 的应用程序。NeuMap 首先通过计算而不是模拟来获得 SNN 的通信模式。基于计算出的脉冲发放率，NeuMap 然后使用贪婪算法将 SNN 划分为多个集群，从而最小化集群之间的通信流量。最后，NeuMap 缩小了搜索空间并采用元启发式算法来寻求最佳的集群到核心方案。本文的主要贡献可以总结如下：
1. 我们研究了SNN的不同参数对脉冲发放率的影响，并通过计算而不是模拟获得了SNN的通信模式。计算可以简化端到端映射过程，并摆脱特定模拟器中模拟带来的挑战。
2. 我们利用突触的特性，提出了局部划分策略，首先将整个网络划分为几个子网络，再将每个子网络划分为多个簇。局部划分策略进一步减少了神经形态核之间的脉冲通信。
3. 我们不是在所有神经形态核中寻找最佳的簇到核方案，而是预先减少搜索空间，并采用具有两个优化目标的元启发式算法来寻求最佳映射方案。搜索空间的减少有助于避免陷入局部最优。

我们用六个基于 SNN 的应用程序对 NeuMap 进行了评估。实验结果表明，与 SpiNeMap 和 SNEAP 相比，NeuMap 的平均能耗分别降低了 84% 和 17%，脉冲延迟分别降低了 55% 和 12%。

本文的其余部分组织如下：第 2 节介绍背景和相关工作。第 3 节详细介绍了所提出的工具链。第 4 节和第 5 节分别讨论了实验设置和实验结果。最后，第 6 节总结了本文。

# 2. Backgroung and Related Works
## 2.3 Architecture of Neuromorphic Hardware
神经形态硬件是一个由多个称为神经形态核心的计算单元组成的大规模并行系统。每个核心实现有限数量的脉冲神经元，每个神经元具有有限数量的输入轴突。片上内存用于存储突触权重、路由表、中间状态和其他参数。核心内的计算并行进行。

与传统的基于总线的通信相比，片上网络 (NoC) [14] 具有灵活性、可扩展性和并行性，因此被广泛用作神经形态硬件中的通信框架。每个核心都通过网络接口 (NI) 连接到路由器。NoC 以分组形式在核心之间传输所有脉冲。如果神经元发出脉冲，处理器将查询路由表并获取目的地的地址。根据查询，将生成包含路由信息的数据包（包括神经元 ID、源和目标地址）并发送到 NoC。

根据NoC的拓扑结构，常用的NoC有两种类型：NoC-tree和NoC-mesh。NoC-tree的例子有BrainScaleS[31]和DYNAPs[12]。具有许多连接通道的网状结构在带宽和可扩展性方面具有优势。NoC-mesh的例子包括SpiNNaker[10]和TrueNorth[8]。

## 2.4 Related Works
图 2 说明了具有四个神经元（N1、N2、N3 和 N4）的 SNN 映射到具有九个核心的神经形态硬件。N1 和 N4 映射到核心 1。N2 和 N3 分别映射到核心 2 和核心 4。当 N2（N3）达到触发阈值并触发尖峰时，处理器通过 NoC 将尖峰传输到核心 1。当 N1 超过触发阈值并产生尖峰时，无需在 NoC 上传输尖峰。如果将四个神经元放在同一个核心中，NoC 上就不会有尖峰消息。因此，将 SNN 优化映射到神经形态硬件有助于缓解通信压力并降低性能损失。

先前的方法通常将 SNN 视为一个图，使用启发式算法直接对整个 SNN 进行分区，并在所有神经形态核心中搜索最佳的簇到核心映射方案。PSOPART [17] 利用粒子群优化 (PSO) [21] 对 SNN 进行分区。SpiNeMap [19] 和 NEUTRAMS [18] 都采用 Kernighan-Lin 图分区算法 (KL) [22] 对 SNN 进行分区。SNEAP [20] 采用多级图分区算法 (ML) [23] 将 SNN 划分为多个簇。KL 算法在满足硬件资源约束的情况下任意将神经元分配到多个簇中。然后，它使用三种交换策略在簇之间交换神经元以减少脉冲消息。 ML 算法迭代地将两个高频通信的神经元合并为一个新节点（粗化步骤）。然后，通过将高频通信的节点分布在同一簇中，将 SNN 初步划分为 k 个簇（初始划​​分步骤）。最后，对神经元进行微调以满足硬件资源约束（去粗化步骤）。ML 算法在减少簇间尖峰消息方面优于 KL 算法 [20]。

划分之后，SpiNeMap 和 SNEAP 使用 PSO 和模拟退火 (SA) 算法 [24] 来搜索最佳的簇到核心映射方案。

# 3.Methods
图 4 显示了我们提出的方法的高级概述，该方法由四个步骤组成，包括获取所有神经元的脉冲发放率、划分 SNN、将簇映射到目标神经形态硬件以及评估。

对于基于 SNN 的传入应用程序，NeuMap 首先提取神经元之间的连接和突触权重。NeuMap 计算输入神经元的脉冲发射时间，然后计算其他神经元的脉冲发射率。NeuMap 使用启发式算法将 SNN 划分为多个簇，从而最大限度地减少簇间脉冲通信。通过减少簇间通信，NeuMap 降低了 NoC 上的能耗和延迟。接下来，NeuMap 使用链路拥塞感知算法将簇映射到选定的核心，从而最大限度地减少每个脉冲消息在到达目的地之前经过的跳跃距离。
![[Pasted image 20241224230939.png]]


# 6. Conclusions and Future Work
在这项工作中，我们引入了 NeuMap，这是一个将基于 SNN 的应用程序映射到神经形态硬件的工具链。NeuMap 计算所有神经元的脉冲发放率以获得通信模式，从而简化了映射过程。然后，NeuMap 利用连接的局部性质并将相邻层聚合为一个子网络。分区仅适用于每个子网络，从而减少了相邻层神经元的分散。最后，NeuMap 采用元启发式算法在缩小的搜索空间中搜索最佳的集群到核心映射方案。我们使用六个基于 SNN 的应用程序评估了 NeuMap。我们表明，与 SpiNeMap 和 SNEAP 相比，NeuMap 分别将平均能耗降低了 84% 和 17%，脉冲延迟降低了 55% 和 12%。在本文中，脉冲发放率的计算仅适用于具有前馈拓扑的 SNN，例如脉冲卷积神经网络。

未来，我们将利用诸如循环拓扑之类的方法。此外，还可以使用其他元启发式算法（例如混合和声搜索算法 [39]）来寻找最佳映射方案。