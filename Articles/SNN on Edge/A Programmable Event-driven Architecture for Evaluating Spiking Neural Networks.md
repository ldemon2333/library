# Abstract
脉冲神经网络 (SNN) 代表第三代神经网络，有望实现新型机器学习应用。然而，在功率受限的系统上评估大规模 SNN（例如，视觉皮层规模）需要显著提高计算效率。SNN 的一个独特属性是其事件驱动性质 - 信息被编码为一系列脉冲，并且随着脉冲在网络中传播而动态生成工作。因此，多核和 GPGPU 上的 SNN 并行实现受到通信和同步开销的严重限制。近年来，人们对非脉冲神经网络的深度学习加速器产生了浓厚的兴趣，然而，这些架构不太适合 SNN 中的动态、不规则并行性。之前对专用 SNN 硬件的研究利用了空间架构，其中每个神经元都分配有一个专用的处理单元，并且通过将多个芯片连接到一个系统中来实现大型网络。虽然这种方法适用于大规模系统，但它并不适合尺寸或成本受限的移动设备。

==PEASE，一种处理器架构==
我们提出了 PEASE，==a Programmable Event-driven processor Architecture for SNN Evaluation. ==PEASE 由脉冲处理单元 (SPU) 组成，这些单元动态调度以执行由脉冲触发的计算。==Instructions to the SPUs are dynamically generated by Spike Schedulers (SSs) that utilize event queues to track unprocessed spikes and identify neurons that need to be evaluated. PEASE 中的内存层次结构完全由软件管理，处理元素使用与 SNN 的通信特性相匹配的两层总线环拓扑相互连接。我们提出了一种方法，将任何给定的 SNN 映射到 PEASE，以便在 SPU 和 SPU 集群之间平衡工作负载，同时在网络层之间进行流水线操作以提高性能。==我们在 RTL 级别实现了 PEASE，并将其综合到 IBM 45 技术中。在 6 个 SNN 基准测试中，我们的 64-SPU PEASE 配置分别比 Intel Xeon E5-2680 CPU 和 NVIDIA Tesla K40C GPU 上的软件实现实现了 7.1×-17.5× 和 2.6×-5.8× 的加速。CPU 和 GPU 上的能量减少分别为 71×-179× 和 198×-467×。

# 1. 介绍
脉冲神经网络。我们专注于脉冲神经网络 (SNN)，它被视为第三代 NN [2]。在 SNN 中，信息表示为脉冲的时间序列。因此，SNN 被认为是将时间信息编码为事件的传感器的自然匹配 [2]。SNN 中的每个神经元都与内部膜电位相关联，当神经元的输入脉冲时，该膜电位会更新。当神经元的电位超过预设阈值时，神经元会产生脉冲。在 SNN 评估过程中，脉冲通过网络传播，输出神经元脉冲的 rate 用于为输入分配类别。训练 SNN 算法以实现最先进的准确性仍然是一个开放的挑战，也是一个活跃的研究领域。==从硬件角度来看，SNN 非常适合紧凑、低功耗的实现，因为神经元不需要硬件乘法器，而脉冲只需要神经元之间的单比特通信。==

尽管有上述好处，但具有超过一百万个神经元和十亿个突触的大规模 SNN 需要远远超出当前计算平台的处理效率。例如，模拟视觉皮层功能的 SNN 需要 ∼2 千兆标量运算和超过 4 GB 的内存容量来处理单个 256×256 图像 [3]。在移动或可穿戴设备上使用这样的 SNN 进行实时视频处理（在亚瓦功率预算下 ∼ 60 GOP）显然是一项重大挑战。因此，探索提高 SNN 执行效率的新途径是其采用的关键。

**相关研究方向**。先前为提高 SNN 效率所做的研究工作可分为三大类。==第一组研究 [3]–[7] 旨在研究在多核和 GPGPU 平台上并行化 SNN 以提高性能的方法。==SNN 是动态工作负载 — 在每个时间步骤中只需要评估一小部分依赖于数据的神经元子集。这会导致不规则的控制流和数据访问模式，并使并行化具有挑战性，因为商业平台针对常规内存访问模式和细粒度 SIMD 并行性进行了优化。

==第二组努力为 SNN 构建了高效的加速器架构 [8]–[13]。==我们的工作属于这一大类，但在方法上有很大不同。以 IBM 的 TrueNorth [9] 为例，先前的努力探索了需要大量晶体管（Truenorth [9] 为 54 亿）的空间架构。更大的网络是通过将多个芯片连接到电路板和机架中来实现的。这种方法在尺寸或成本受限的应用程序（移动/可穿戴设备）中是不可行的。

==最后一组努力探索使用晶体管 [14] 优化脉冲神经元和突触的电路设计==，以及使用新兴器件技术（==如忆阻器 [15]、[16] 和自旋电子学 [17]、[18]==）来与 SNN 中的计算原语本质上匹配。这些方法是对 PEASE 的补充，即它们可用于实现 PEASE 中的PE。

**PEASE Architecture**.与前几代 NN 相比，SNN 的一个独特属性是其==事件驱动性质==。在每个时间步骤中，只需要评估一小部分数据相关的网络连接子集。==我们的架构 PEASE 专门设计用于解决工作负载中的这种动态性==。PEASE 由脉冲处理单元 (SPU) 组成，这些单元被动态调度以执行由脉冲触发的计算。脉冲调度器 (SS) 利用事件队列来跟踪未处理的脉冲事件，识别必须评估的神经元，并动态生成 SPU 的指令。拥有专用的硬件脉冲调度器对于效率至关重要，因为每个神经元的工作粒度相对较小。PEASE 中的内存层次结构完全由软件管理。它由一个片外内存和连接到每个 SPU 的片上暂存器组成，用于保存神经元状态和突触权重。为了实现可扩展性，PEASE 被组织成一个两层的层次结构。在第一层，多个 SPU 和一个 SS 使用脉冲总线和指令总线连接起来，形成一个 SPU 集群。这使得 SS 能够向集群中的每个 SPU 发送指令，并从每个 SPU 接收脉冲。按照 NN 的分层结构，多个 SPU 集群以环状连接。

我们提出了一种将任何给定的 SNN 映射到 PEASE 的方法。网络的每一层都根据其平均计算负载分配给一个或多个 SPU 集群，并且相邻层优先映射到相邻的 SPU 集群。为了进一步提高性能，SPU 集群以流水线方式跨时间步骤运行。

In summary, the key contributions of our work are as follows.
- 我们提出了 PEASE，这是一种用于 SNN 评估的可编程架构，它直接解决了 SNN 的事件驱动、动态特性。
- PEASE 与以前的架构有很大不同，它利用动态调度的脉冲处理单元 (SPU)，专门用于执行由脉冲触发的计算，以及脉冲调度器 (SS)，用于跟踪未处理的脉冲并动态生成 SPU 的指令。
- PEASE 采用两层层次结构，具有适合 SNN 中通信模式的总线环互连拓扑。神经元状态和突触权重分布在一组软件管理的暂存器中，从而定位数据访问。
- 在 6 个 SNN 基准测试中，我们采用 64 个 SPU 和 4 个 SS 实现的 PEASE 分别比 Intel Xeon E5-2680 CPU 和 NVIDIA Tesla K40C GPU 上的软件实现实现了 7.1×-17.5× 和 2.6×-5.8× 的加速。CPU 和 GPU 上的能量减少分别为 71×-179× 和 198×-467×。

# 2. 相关工作
本节总结了之前为提高 SNN 实现效率所做的努力，并在其背景下介绍了这项工作的贡献。广义上讲，之前的努力可以分为三个方向。

**软件并行化**。第一组努力的目标是在商业多核平台 [4]、[5] 和 GPGPU [3]、[6]、[7] 上实现 SNN 的软件并行化。然而，SNN 的事件驱动特性（其中在每个时间步骤中评估网络连接的动态子集）导致计算和内存访问模式不规则，从而导致可扩展性差。

**加速器架构**。第二组努力为 SNN 开发专用硬件 [8]–[13]。这些努力提出了空间架构，其中使用的处理元素数量与评估网络的复杂性直接相关。虽然这种方法非常适合大规模并行系统（服务器和集群）的环境，但它不适用于成本和尺寸受限的移动设备，而这正是我们工作的主要目标。

**精度有限**。许多先前的努力通过施加诸如精度有限之类的功能约束来实现能源效率。例如，TrueNorth [9] 极大地限制了突触精度，以允许每个突触用 1 个 SRAM 单元实现突触阵列。最近的研究 [19]、[20] 通过神经元复制和受限训练解决了这一限制，尽管对效率有一定影响。==PEASE 的主要贡献是动态调度的事件驱动架构，它可以直接实现具有有限 PE的任意 SNN 拓扑。诸如精度有限之类的优化也可以应用于 PEASE，以进一步提高其效率。==

**电路和新兴技术**。==人们已经探索了用于脉冲神经元和突触的优化数字和模拟 CMOS 电路 [11]、[14]。最近的努力还使用了新兴的后 CMOS 器件技术，如忆阻器 [15]、[16] 和自旋电子学 [17]、[18] 来实现神经元和突触。==这些努力在很大程度上是对 PEASE 的补充，因为我们==专注于针对 SNN 的事件驱动特性进行架构优化。==

# 7. 结论
脉冲神经网络 (SNN) 是一种新兴的 NN 类，其中的信息在时间上被编码为一系列脉冲。虽然 SNN 有望实现新的应用，但它们的计算需求远远超出了现代计算平台的能力。==为了应对能源受限设备环境下的这一挑战，我们提出了 PEASE，这是一种用于 SNN 评估的可编程架构。==PEASE 满足了 SNN 的事件驱动特性，使用可以动态调度以执行由脉冲触发的计算的脉冲处理单元，以及跟踪未处理的脉冲并在运行时为 SPU 生成指令的脉冲调度器。==PEASE 采用软件管理的内存层次结构和两层总线环互连拓扑，与 SNN 的通信特性相匹配。==在 6 个 SNN 基准测试中，PEASE 比商用 Intel Xeon 服务器和 NVIDIA Tesla K40C GPU 实现了数量级的加速和两个数量级的能耗降低。

---
硬件上：
- 为了应对能源受限设备，提出了 PEASE，这是一种 programmable architecture for SNN evaluation。
- PEASE 利用 SNN 中脉冲的时间稀疏性以事件驱动的方式执行计算，PEASE caters to the event-driven nature of SNNs using Spike Processing Units that can be dynamically scheduled to execute computations triggered by spikes, and Spike Schedulers that track unprocessed spikes and generate instructions for the SPUs at runtime.
软件上：
- PEASE adopts a software-manged memory hierarchy, and a two-tiered bus-ring interconnect topology matching the communication characteristics of SNNs.

