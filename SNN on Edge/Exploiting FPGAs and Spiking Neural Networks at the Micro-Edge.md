本文概述了 EdgeAI 项目中以 FPGA 为中心的初步努力，针对极其受限的功率-能量参数与执行人工智能 (AI) 算法的高性能和准确性需求相交的场景。在介绍 EdgeAI 项目的一般性之后，我们的讨论围绕项目目标展开，即同时利用基于事件的脉冲神经网络和低端 FPGA 芯片进行超低功耗近传感器 AI 推理。我们介绍了这种方法的硬件/软件实现以及项目用例的早期结果。

# 1. At-the-Edge AI and the EdgeAI Project
边缘人工智能 (AI) 为网络边缘的机器学习 (ML) 和深度学习 (DL) 提供支持，更接近传感器和执行器，用于本地化数据收集和处理、减少延迟、增强数据隐私和安全性，并减少对云连接的需求。

然而，这带来了在资源受限的平台上执行复杂计算工作负载的挑战。因此，它需要处理多种技术并优化能源使用。

EdgeAI 项目 [1] 是 42 个合作伙伴共同努力的结果，也是关键数字技术 (KDT) 联合项目 (JU) 的一部分，旨在应对此类挑战，在欧洲向更智能的边缘处理解决方案的数字化演进中发挥关键作用。该项目专注于创造新的电子零件和系统，改进处理设置，改善连接性，以及开发软件、算法和中间层技术。

## 1.1 EdgeAI Applications
EdgeAI 的主要目标是推进跨 AI 技术各个层面的解决方案，最终为各个工业领域创建实时执行的多模式边缘 AI 实现。

EdgeAI 项目合作伙伴致力于在五大工业价值链的 20 个示范者中展示所开发方法的适用性：
- 数字工业、
- 能源、
- 农业食品和饮料、
- 移动性和
- 数字社会，
同时考虑每个示范者固有的性能、安全性、信任和能源效率需求。EdgeAI 旨在为各个工业部门带来益处，为社会普遍采用边缘 AI 做出重大贡献。

## 1.2 Reconfigurable Computing in EdgeAI
EdgeAI愿景涵盖整个计算连续体[2]，如图1所示，包括：
- 微边缘（嵌入式微控制器、传感器和执行器等中的处理单元）
- 深边缘（网关、移动电话、可编程逻辑控制器等中提供扩展处理能力的处理单元）
- 元边缘（本地高性能边缘处理微服务器，结合不同的微控制器和处理器执行特定操作）
![[Pasted image 20241216140056.png]]

为了实现这一目标，不同的研究任务集中于广泛的异构处理平台，旨在融合不同的计算解决方案，如中央处理单元 (CPU)、图形处理单元 (GPU)、张量处理单元 (TPU)、专用集成电路 (ASIC)、神经形态处理单元 (NPU)、片上系统 (SoC) [2]。

此外，由于适应性是关键要求之一，并且重新配置处理节点并轻松使其适应不同用例和使用模式的可能性至关重要，因此现场可编程门阵列 (FPGA) 是该项目和整个 AI 领域的主要关键支持技术。因此，社区投入了大量研究精力来优化它们在边缘计算协议中对 AI 算法的推理。然而，到目前为止，大多数方法都集中在利用 FPGA 结构上的资源并行性，以惊人的数据速率处理图像流，容忍符合深度或元边缘的功耗数据，而如何使用 FPGA 处理微边缘的传感器数据仍然是一个悬而未决的问题。在这个领域，在项目的初始阶段，出现了两条主要的研究路线。一方面，EdgeAI 研究人员已经
探索并确认了 FPGA 在元边缘的使用，重点关注卷积神经网络 (CNN) 的工具支持工作量减少，实施混合量化技术，使中端 FPGA在能效方面优于其他替代方案 [2]。

另一方面，我们研究了 FPGA 在微边缘的使用，用于更节能的基于事件的算法（如脉冲神经网络 (SNN)）的推理，将轻量级拓扑与低功耗可重构设备相结合，以在几毫瓦的范围内实现推理。

在本文的其余部分，我们将重点关注后者的努力，概述硬件/软件开发的 IP 并简要介绍已取得的成果。

# 2 Background
SNN 是一种有前途的解决方案，具有节能、事件驱动的处理能力。然而，要利用事件驱动处理的优势，通常需要专门的计算架构。

由于 FPGA 具有高度可定制的硬件设计，因此非常适合执行这些计算任务。它们的设计允许利用稀疏神经元放电模式。核心数字信号处理器 (DSP) 切片经过精心设计，可以熟练处理一系列算术运算，包括加法、乘法和乘法累加。另一方面，BRAM（块随机存取存储器）单元由于其适应性设计和尺寸，特别适合集成 SNN 模型并促进数据访问和管理。虽然最有效的纯 SNN 处理器是神经形态 ASIC，如 Truenorth、Spinnaker 和 Loihi，但在相关文献中，一些努力集中在利用 FPGA 来增强灵活性和集成度 [3]。一些旨在模拟生物逼真的神经组织 [4]，而另一些则专注于通过 SNN 处理事件编码图像，依靠中高端 FPGA 设备 [5,6]。其他研究 [7,8] 针对较小的设备，强调二维输入（如来自 DVS 摄像机的图像）的脉冲卷积层。然而，这些实现可能不适合低功耗智能传感器，因为它们对功率/能量/成本的要求更高。

在 EdgeAI 中，我们探索了在低功耗 FPGA 上执行 SNN，以证明这种方法在电池供电且经济高效的传感器节点的可行功率预算内的实用性。

# 3. Light-Weight SSNs for the Mircro-Edge
我们创建了一个架构模板，将其命名为 SYNtzulu，并在各种近传感器数据处理场景中对其进行了测试。图 2 说明了其系统级架构。它在 Lattice iCE40UP5k FPGA 上实现，主要处理元素包括：
– RISC-V 核心处理输入/输出数据流并配置 SYNtzulu；
– 8 路 SIMD SNN 引擎执行由 LIF 神经元密集层组成的前馈 SNN 的推理。
![[Pasted image 20241216140524.png]]
SNN 引擎包括一个可配置的编码槽，用于预处理传感器数据以获得脉冲序列，以及一个双解码槽，用于将输出脉冲序列转换为分类结果。此外，它还专门用于执行利用脉冲稀疏性的 SNN 推理，并实现低功耗。