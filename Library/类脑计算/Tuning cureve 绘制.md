调谐曲线用于表征感觉和运动神经元的特性。

# 介绍
研究人员从初级运动皮质(m1区)的一个神经元记录下来，动物拿着一个操作杆，在动物面前的一个平面上，将他的手臂朝着8个方向中的一个方向移动，这8个方向均匀地分布在一个圆周上。这只猴子在每个方向上完成了17次试验。

## Raw Data
保存在CSV文件中，有4列，每一行对于记录神经元的动作电位。第1列是尖峰的实际时间；第2列是试验方向；第3列是试验编号；第4列是以动物开始移动其手臂为中心的尖峰时间。数据包含8个运动方向，每个方向有17个试验。

# 处理数据
提取第2列8个方向，角度制
![[Pasted image 20240926142527.png]]

接下来，我们将每个方向的试验分组。将尖峰时间按方向和试验次数排序
![[Pasted image 20240926142825.png]]

# 使用栅格图可视化峰值时间
首先，创建栅格图，观察神经元对于不同方向动作如何反应。
- X轴是以秒为单位的时间，每个尖峰表示为一条垂直线。
- 首先创建栅格图，给标题和命名x轴
![[Pasted image 20240926143053.png]]
- 然后用1982年Georgopolus的格式绘制光栅
![[Pasted image 20240926143144.png]]
![[Pasted image 20240926143202.png]]

# 创建Peri-Stimulus Time Histograms(PSTHs)
要创建PSTH，需要将峰值、多次试验的平均值，转换为发射率并显示直方图。然后对每个方向重复这个过程。

- 这里我们计算所有试验中每个bin中峰值数量，这里bin设置为20ms

![[Pasted image 20240926143535.png]]

- 接下来，对试验次数平均，并通过除以bin size转换为发射率，峰值单位/秒
![[Pasted image 20240926143744.png]]
- 最后，可视化PSTHs，X轴是时间，y轴是峰值/s
![[Pasted image 20240926143845.png]]

![[Pasted image 20240926143905.png]]

# 绘制Tuning Curve
要创建Tuning Curve，将每个PSTH转换为每个方向的一个值，并创建结果图。然后我们可以拟合高斯曲线的数据，以绘制Tuning Curve。

- 对于这个数据，我们采取峰值在-100ms到100ms左右手臂运动，这需要re-binned
![[Pasted image 20240926144237.png]]

- 转换为发放率
![[Pasted image 20240926144312.png]]
![[Pasted image 20240926144349.png]]
- 用高斯函数拟合数据有点棘手，因为我们的 x 值实际上是圆形的，因此我们的曲线在技术上是周期性的。对于这个特殊的调谐曲线，这并不重要，但是你可以想象，如果神经元的优先方向接近于0，将会产生多大的困难。我们可以通过拟合两个高斯的和(平均值和宽度相等，但偏移中心)来解决这个问题。
- 我们将种子拟合函数来帮助它收敛。因为我们知道数据的最大值以及最大值出现的方向，所以可以使用该信息查看函数。
![[Pasted image 20240926144631.png]]
- 拟合曲线
![[Pasted image 20240926144701.png]]


# 进一步探索
- 为什么bin size 总是要大于 1ms？
- 将tuning curve 表示为极坐标图，为什么这是一个有用的表示？
- 通过tuning curve可以预测什么和不可以预测什么，例如，如果你知道神经元的发放频率，你能预测感兴趣的参数的值吗？