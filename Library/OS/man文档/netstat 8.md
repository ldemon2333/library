`netstat` 是一个网络相关的命令行工具，用于显示网络连接、路由表、接口统计信息等网络状态信息。它在 Linux 系统和类 Unix 系统中都很常见，可以帮助你分析网络状态、调试网络问题和监控系统的网络活动。

### 基本语法

```bash
netstat [选项]
```

### 常用选项和用法

以下是一些常用的 `netstat` 选项和用途：

1. **显示所有连接和监听端口**
    
    ```bash
    netstat -a
    ```
    
    - 显示所有连接（包括服务器和客户端的连接）和监听的端口。
2. **显示所有 TCP 连接**
    
    ```bash
    netstat -at
    ```
    
    - 仅显示 TCP 连接（包括监听端口和已建立的连接）。
3. **显示所有 UDP 连接**
    
    ```bash
    netstat -au
    ```
    
    - 仅显示 UDP 连接。
4. **显示监听的端口**
    
    ```bash
    netstat -l
    ```
    
    - 显示当前正在监听的端口，不显示已建立连接。
5. **显示详细的网络连接信息**
    
    ```bash
    netstat -n
    ```
    
    - 显示 IP 地址和端口号的数字表示，而不是尝试解析为域名和服务名。
6. **显示路由表**
    
    ```bash
    netstat -r
    ```
    
    - 显示当前的路由表信息。
7. **显示接口统计信息**
    
    ```bash
    netstat -i
    ```
    
    - 显示每个网络接口的流量统计信息，如数据包、错误、丢包等。
8. **显示与网络接口相关的详细信息**
    
    ```bash
    netstat -i -e
    ```
    
    - 显示接口的详细统计信息，包括网络接口的错误、丢包、数据包数量等。
9. **显示网络连接的进程ID (PID)**
    
    ```bash
    netstat -p
    ```
    
    - 显示每个网络连接的进程 ID（PID）和进程名称。需要 root 权限来查看其他用户的进程信息。
10. **显示所有 TCP 连接的状态**
    
    ```bash
    netstat -t
    ```
    
    - 显示所有 TCP 连接的状态，如 ESTABLISHED、TIME_WAIT 等。
11. **显示接口流量统计**
    
    ```bash
    netstat -s
    ```
    
    - 显示各种网络协议的统计信息（包括 TCP、UDP、ICMP 等），用于调试和性能监控。
12. **定期刷新显示网络状态**
    
    ```bash
    netstat -c
    ```
    
    - 每隔一段时间刷新一次 `netstat` 的输出，默认每 1 秒刷新一次，适合动态监控网络连接。

### 示例

1. **查看当前所有的网络连接及监听端口**
    
    ```bash
    netstat -tuln
    ```
    
    - `-t`：显示 TCP 连接
    - `-u`：显示 UDP 连接
    - `-l`：显示正在监听的端口
    - `-n`：显示数字格式的 IP 和端口号
2. **查看当前系统中 TCP 连接的状态**
    
    ```bash
    netstat -at
    ```
    
3. **查看网络接口的流量统计信息**
    
    ```bash
    netstat -i
    ```
    
4. **查看系统的路由表**
    
    ```bash
    netstat -r
    ```
    
5. **查看网络连接和对应的进程**
    
    ```bash
    sudo netstat -tulnp
    ```
    
    - `-p` 显示进程 ID 和进程名称（需要管理员权限）。

`netstat` 是一个非常常用的网络工具，用于显示网络连接、路由表、接口统计等信息。其常用来查看网络连接状态、端口使用情况等。在不同的操作系统中，`netstat` 的输出可能略有不同，但基本的字段是类似的。

当你使用 `netstat` 命令时，输出通常会包括以下几个主要字段：

### 1. **Proto**

- **表示：** 网络协议。
- **常见值：**
    - `tcp`：传输控制协议（Transmission Control Protocol）。
    - `udp`：用户数据报协议（User Datagram Protocol）。
    - `tcp6`：IPv6 上的 TCP 协议。
    - `udp6`：IPv6 上的 UDP 协议。

### 2. **Recv-Q (接收队列)**

- **表示：** 接收队列中的字节数（表示接收缓存中的数据）。
- **详细解释：**
    - 如果 `Recv-Q` 大于零，说明本地的 TCP 接口正等待数据被读取。如果值为零，说明接收队列为空。
    - 这个字段对于调试网络延迟或瓶颈很有帮助。

### 3. **Send-Q (发送队列)**

- **表示：** 发送队列中的字节数（表示发送缓存中的数据）。
- **详细解释：**
    - 如果 `Send-Q` 大于零，说明本地系统正在等待数据被远程主机确认或者数据正在被排队等待发送。
    - 如果 `Send-Q` 很大，可能是网络链路延迟、TCP 拥塞控制问题，或者接收方的应用程序无法及时读取数据。

### 4. **Local Address (本地地址)**

- **表示：** 本地计算机的 IP 地址和端口。
- **格式：** `IP:port`。
    - 对于 TCP 和 UDP 连接，它表示本地机器的 IP 地址和端口号。
    - 如果是 `0.0.0.0:port` 或 `[::]:port`，表示该端口正在监听所有网络接口的请求。
    - 如果是 `127.0.0.1:port` 或 `[::1]:port`，表示该端口只在本地回环接口上监听。

### 5. **Foreign Address (外部地址)**

- **表示：** 连接的远程地址和端口。
- **格式：** `IP:port`。
    - 对于 TCP 连接，它显示远程计算机的 IP 地址和端口号。
    - 对于 UDP 连接，通常只有源 IP 和端口，因为 UDP 是无连接的协议，远程地址只有在特定情境下（如与服务端建立联系）才显示。
    - 如果连接是处于监听状态，`Foreign Address` 列会显示 `*:*`。

### 6. **State (连接状态)**

- **表示：** TCP 连接的状态（仅适用于 TCP 连接）。
- **常见值：**
    - `LISTEN`：正在监听连接请求的端口。
    - `ESTABLISHED`：已建立连接，通信正常。
    - `SYN_SENT`：客户端发起连接请求，等待服务器响应。
    - `SYN_RECV`：服务器接收到连接请求，等待客户端确认。
    - `FIN_WAIT1`：等待关闭连接的确认。
    - `FIN_WAIT2`：等待对方关闭连接。
    - `CLOSE_WAIT`：等待本地应用程序关闭连接。
    - `TIME_WAIT`：确保远程终端收到最后的确认报文（连接已关闭，等待一段时间）。
    - `CLOSING`：双方同时关闭连接。
    - `LAST_ACK`：等待远程端确认关闭连接。
    - `CLOSED`：连接已经关闭。

### 7. **PID/Program name (进程 ID / 程序名称)**

- **表示：** 使用该连接的进程 ID（PID）和进程名称。
- **用法：** 如果你使用 `netstat -p`，你可以看到每个连接和监听端口的进程 ID 和程序名称。例如，`PID/Program name` 可能显示 `1234/httpd`，表示 PID 为 1234 的进程（`httpd`）正在使用该端口。
- **注：** 这个字段通常需要超级用户权限（`sudo`）才能查看。

---

### 示例输出

```bash
$ netstat -tuln
Proto Recv-Q Send-Q Local Address           Foreign Address         State
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN
tcp6       0      0 :::80                   :::*                    LISTEN
udp        0      0 0.0.0.0:123             0.0.0.0:*               
udp6       0      0 :::123                  :::*                    
```

### 字段解析：

- **Proto**: `tcp`, `tcp6`, `udp`, `udp6`。
- **Recv-Q** 和 **Send-Q**: 都是 `0`，说明没有积压的数据。
- **Local Address**:
    - `0.0.0.0:22` 表示监听所有网络接口的 22 端口（通常用于 SSH）。
    - `:::80` 表示监听所有 IPv6 接口的 80 端口（通常用于 HTTP）。
- **Foreign Address**: `0.0.0.0:*` 或 `:::*`，表示这是一个监听端口，尚未与任何远程地址建立连接。
- **State**: `LISTEN`，表示这些端口正在监听连接请求。

---

