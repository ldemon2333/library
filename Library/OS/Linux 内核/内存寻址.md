# 内存地址
三种不同的地址：
- 逻辑地址（logical address）：每一个逻辑地址都由一个段（segment）和偏移量组成。
- 线性地址（linear address）（virtual address）：是一个 32 位无符号整数，可以用来表示 4 GB 的地址。
- 物理地址
内存控制单元（MMU）通过一种称为分段单元（segmentation unit）的硬件电路把一个逻辑地址转换成线性地址；接着，第二个称为分页单元（paging unit）的硬件电路把线性地址转换成一个物理地址。
![[Pasted image 20241129203121.png]]
在多处理器系统中，所有CPU都共享同一内存；这意味着RAM芯片可以由独立的CPU并发地访问。因为在RAM芯片上的读或写操作必须串行地执行，因此一种所谓内存仲裁器（memory arbiter）的硬件电路插在总线和每个RAM芯片之间。其作用是如果某个RAM芯片空闲，就准予一个CPU访问，如果该芯片忙于为另一个处理器提出的请求服务，就延迟这个CPU的访问。

# 硬件中的分段
从 80286 模型开始，Intel 微处理器以两种不同的方式执行地址转换，这两种方式分别称为实模式（real mode）和保护模式（protected mode）。

## 段选择符和段寄存器
一个逻辑地址由两部分组成：一个段标识符和一个指定段内相对地址的偏移量。段标识符是一个 16 位长的字段，称为段选择符（Segment Selector），而偏移量是一个 32 位长的字段。
![[Pasted image 20241129203849.png]]
段寄存器的唯一目的是存放段选择符。这些段寄存器称为 cs, ss, ds, es, fs 和 gs。

6 个寄存器中 3 个有专门的用途：
- cs：代码段寄存器
- ss：栈段寄存器，指向包含当前程序栈的段
- ds：数据段寄存器，指向包含静态数据或者全局数据段

cs 寄存器含有一个两位的字段，用以指明 CPU 的当前特权级（Current Privilege Level，CPL）。值为 0 代表最高优先级，而值 3 最低。Linux 只用 0 级和 3 级，分别称之为内核态和用户态。

## 段描述符
每个段由一个 8 字节的段描述符（Segment Descriptor）表示，它描述了段的特征。段描述符放在全局描述符表（Global Descriptor Table，GDT）或局部描述符表（Local Descriptor Table，LDT）中。

通常只定义一个GDT，而每个进程除了存放在GDT中的段之外如果还需要创建附件的段，就可以有自己的LDT。GDT在主存中的地址和大小存放在 gdtr 控制寄存器中，当前正被使用的 LDT 地址和大小放在 ldtr 控制寄存器中。

![[Pasted image 20241129204748.png]]


![[Pasted image 20241129204738.png]]