# MQTT 设备接入快速体验
## 1. 创建产品
![[Pasted image 20250115120002.png]]
登录平台，进入"产品中心"-"产品开发"，点击右上角"创建产品"按钮。
![[Pasted image 20250115120008.png]]
如图所示书写相关信息，配置相关详情可参考[创建产品](https://dmp.ictsoft.cn/docs/content/%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5/%E5%88%9B%E5%BB%BA%E4%BA%A7%E5%93%81.md)。点击右边"创建"按钮完成创建。

此时回到"产品开发"可以看到刚刚创建的产品。

点击查看，进入产品概览。依次点击"功能定义"，"编辑草稿版本"，对产品功能进行定义。

点击“添加自定义功能”，创建属性，如下图所示。

![[Pasted image 20250115120033.png]]
创建服务，如下图所示。
![[Pasted image 20250115120047.png]]
![[Pasted image 20250115120050.png]]
![[Pasted image 20250115120054.png]]
添加完成后。点击“发布新版本”，更新正式版物模型。正式版物模型如下图。
![[Pasted image 20250115120104.png]]

## 2. 创建设备
完成产品创建后，进入"产品中心"-"设备管理"，点击"创建设备"按钮。
![[Pasted image 20250115120117.png]]
如图所示填写设备信息。其中"所属产品为第一步中创建的产品"。 "设备ID"则需要为唯一标识。

点击"确定"按钮完成设备创建。

## 3. 获取连接信息
完成设备创建后，回到"产品中心"-"产品开发"中，点击第一步创建的产品。进入产品概览，可以获取响应的连接信息。
![[Pasted image 20250115120205.png]]
其中主要使用到的参数是"设备接入信息"。 此例中用到的是MQTT接入方式：172.22.100.131:1883

进入"设备管理"，选择创建的设备，点击"查看"。

即可查看设备详细信息。
![[Pasted image 20250115120212.png]]
如图所示可以得到设备的设备ID、设备所属产品pk以及devSecret。

点击"Topic列表"可以获得MQTT连接需要用到的Topic。
![[Pasted image 20250115120219.png]]
通过获取到的数据进行处理得到连接参数。处理方式参考[鉴权方式](https://dmp.ictsoft.cn/docs/content/%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5/MQTT%E5%8D%8F%E8%AE%AE/%E9%89%B4%E6%9D%83%E6%96%B9%E5%BC%8F.html)。

# 4. 设备模拟连接
按照第三步中获取的连接信息填写到设备模拟器中。
![[Pasted image 20250115120243.png]]
连接成功后，平台上，进入设备管理，可以看到设备的设备状态为在线。

# 5. 属性上报
![[Pasted image 20250115120315.png]]
如图所示，添加订阅Topic，这里添加了属性上报响应的Topic
![[Pasted image 20250115120711.png]]
如图所示，在下方输入发布Topic和payload，发布；上方右侧为发布的消息，左侧为订阅收到的消息。
![[Pasted image 20250115120717.png]]
平台上，进入设备详情，点击“上下行数据”，可以看到属性上报的数据。

# 6. 服务调用
![[Pasted image 20250115121346.png]]
如图所示，在模拟器上添加服务调用的订阅Topic。

回到平台-"设备详情"-"在线调试"
![[Pasted image 20250115121353.png]]
此时在模拟器也可以顺利收到平台下发的命令。
![[Pasted image 20250115121400.png]]
设备可以上报服务调用响应。
![[Pasted image 20250115121405.png]]
上下行数据中，点击服务调用的数据跟踪，可以看到服务调用响应。
![[Pasted image 20250115121413.png]]




